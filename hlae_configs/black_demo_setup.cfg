// Smoke matte stream:

// start with a base stream and turn the world black, easier to filter out than green
mirv_streams add baseFx bfs

mirv_streams edit bfs clientEffectTexturesAction black
mirv_streams edit bfs worldTexturesAction black
mirv_streams edit bfs skyBoxTexturesAction black
mirv_streams edit bfs staticPropTexturesAction black
mirv_streams edit bfs cableAction black
mirv_streams edit bfs playerModelsAction draw
mirv_streams edit bfs weaponModelsAction black
mirv_streams edit bfs statTrakAction black
mirv_streams edit bfs shellModelsAction black
mirv_streams edit bfs otherModelsAction black
mirv_streams edit bfs decalTexturesAction black
mirv_streams edit bfs effectsAction draw // wish this could be black, but then players don't draw early for some reason
mirv_streams edit bfs shellParticleAction black
mirv_streams edit bfs otherParticleAction black
mirv_streams edit bfs stickerAction black
mirv_streams edit bfs errorMaterialAction black
mirv_streams edit bfs otherAction black
mirv_streams edit bfs writeZAction black
mirv_streams edit bfs vguiAction black

mirv_streams edit bfs drawHud 0
mirv_streams edit bfs drawViewModel 0

// add back smoke
mirv_streams edit bfs actionFilter clear
mirv_streams edit bfs actionFilter add "particle/vistasmokev1/vistasmokev1" draw
mirv_streams edit bfs actionFilter add "particle/vistasmokev1/vistasmokev1_smokegrenade" draw
mirv_streams edit bfs actionFilter add "particle/vistasmokev1/vistasmokev1_emods" draw
mirv_streams edit bfs actionFilter add "particle/vistasmokev1/vistasmokev1_emods_impactdust" draw
mirv_streams edit bfs actionFilter add "particle/vistasmokev1/vistasmokev1_fire" draw
mirv_streams edit bfs actionFilter add "effects/overlaysmoke" draw
mirv_streams edit bfs smokeOverlayAlphaFactor 1

// remove tracers absolutely
r_drawtracers 0
r_drawtracers_firstperson 0
r_drawtracers_movetonotintersect 0

// remove blood
mirv_streams edit bfs actionFilter add decals/blood\* noDraw
mirv_streams edit bfs actionFilter add particle/spray1/\* noDraw
mirv_streams edit bfs actionFilter add particle/blood\* noDraw
mirv_streams edit bfs actionFilter add particle/impact/\* noDraw
mirv_streams edit bfs actionFilter add effects/blood\* noDraw
mirv_streams edit bfs actionFilter add particle/headshot/\* noDraw
mirv_streams edit bfs actionFilter add decals/brick/\* noDraw
mirv_streams edit bfs actionFilter add particle/sparks/\* noDraw
mirv_streams edit bfs actionFilter add particle/star\* noDraw

// remove dead bodies as those are different entities from players
mirv_streams edit bfs actionFilter addEx "className=class C_CSRagdoll" "action=black"

// set playback settings
demo_timescale 0.25

// config player colors
mirv_streams actions add replace afxWhTRed "afx/wh/t" "overrideColor=1 0 0" "overrideBlend=1"
mirv_streams actions add replace afxWhTGreen "afx/wh/t" "overrideColor=0 1 0" "overrideBlend=1"
mirv_streams actions add replace afxWhTBlue "afx/wh/t" "overrideColor=0 0 1" "overrideBlend=1"
mirv_streams actions add replace afxWhTRedBlue "afx/wh/t" "overrideColor=1 0 1" "overrideBlend=1"
mirv_streams actions add replace afxWhTGreenBlue "afx/wh/t" "overrideColor=0 1 1" "overrideBlend=1"
mirv_streams actions add replace afxWhCTRed "afx/wh/ct" "overrideColor=1 0 0" "overrideBlend=1"
mirv_streams actions add replace afxWhCTGreen "afx/wh/ct" "overrideColor=0 1 0" "overrideBlend=1"
mirv_streams actions add replace afxWhCTBlue "afx/wh/ct" "overrideColor=0 0 1" "overrideBlend=1"
mirv_streams actions add replace afxWhCTRedBlue "afx/wh/ct" "overrideColor=1 0 1" "overrideBlend=1"
mirv_streams actions add replace afxWhCTGreenBlue "afx/wh/ct" "overrideColor=0 1 1" "overrideBlend=1"

// manual stuff: 
// make sure to mask out your teammates, so only 1 of 2 next lines - first for t, second for ct
//mirv_streams edit bfs actionFilter addEx "teamNumber=2" "action=noDraw"
//mirv_streams edit bfs actionFilter addEx "teamNumber=3" "action=noDraw"
// get all the entities, and 
//mirv_listentities isPlayer=1
//mirv_streams edit bfs actionFilter addEx "handle=11403267" "action=afxWhTRedBlue"
// malia is blue
// Kcirrem is red
// Pinkary is pink
// mirv_streams edit bfs actionFilter addEx "handle=11665411" "action=afxWhTRed"
// mirv_streams edit bfs actionFilter addEx "handle=61210629" "action=afxWhTGreen"
// mirv_streams edit bfs actionFilter addEx "handle=48562183" "action=afxWhTBlue"
// 11403267 - for smoke demo